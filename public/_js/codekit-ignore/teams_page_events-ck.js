$(function(){function e(e){return e.attr("contenteditable")=="true"?!0:!1}function t(t){e(t)?t.attr("contenteditable","false"):t.attr("contenteditable","true")}function n(e,t){$("a.save-team").off("click").on("click",function(){var n=$("#school-name").text(),r=$(this).closest("li").find("h3").text(),i=$(this).closest("li").find("span").text();console.log("school: "+n+"\n team: "+"team"+"\n gender: "+i);$.ajax({url:"/"+n+"/teams/"+e+"-"+t,data:{"edit-team-name":r,"edit-team-gender":i},dataType:"json",type:"put"}).done(function(){console.log("save new team name successful")}).fail(function(e){console.log("save new team name failed")}).always(function(){console.log("end save-team function")});$(this).closest("li").find("h3").attr("contenteditable","false");$(this).closest("li").find(".team-buttons").show();$(this).closest("li").find(".team-edits").hide()})}function r(e,t){$("form#delete-team-form").off("click").on("click",function(n){console.log("delete-team confirmed");$.ajax({url:t,type:"DELETE",dataType:"json"}).done(function(){console.log("delete successful");e.parent().remove()}).fail(function(e){}).always(function(){$("a.close-reveal-modal").trigger("click")})})}$(".team-edits").hide();$("ul#teams-list").on("click","a.edit-team",function(r){var i=$(this);console.log(i);var s=$(this).closest("li").find("h3"),o=s.text();t(s);if(e(s)){var u=$(this).closest("li").find("h3").text(),a=$(this).closest("li").find("span").text();$(this).closest("li").find(".team-buttons").hide();$(this).closest("li").find(".team-edits").show();n(u,a)}});$("a.cancel-team").on("click",function(){document.execCommand("undo");$(this).closest("li").find("h3").attr("contenteditable","false");$(this).closest("li").find(".team-buttons").show();$(this).closest("li").find(".team-edits").hide()});$("a#delete-team").on("click",function(e){console.log("clicked delete");e.preventDefault();var t,n,i,s,o=$(this);console.log(o.closest("li").find("h3").text());t=$("#school-name").text();n=o.closest("li").find("h3").text();i=o.closest("li").find("span").text();s="/"+t+"/teams/"+n+"-"+i;console.log("url:\n",s);$("#deleteModal.reveal-link").trigger("click");r(o,s)});var i=$("#teams-list h3").map(function(){return $(this).text()}).get(),s=$("#school-name").text();$("#create-team-submit").on("click",function(e){console.log("clicked from "+this);var t,n,r,o;t=$(this);n=$("#team-name").val();r=$("#team-gender").val();o="/"+s+"/teams/"+n+"-"+r;console.log("teamsArray:"+i);console.log($.inArray(n,i));$.ajax({url:o,type:"POST",contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"json"}).done(function(e){console.log("data saved: "+e);window.location.reload();$("a.close-reveal-modal").trigger("click")}).fail(function(e){console.log("failure: "+e);console.dir(e)}).always(function(){});e.preventDefault()})});